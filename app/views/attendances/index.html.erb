<div class="max-w-4xl mx-auto p-4">
  
  <div class="bg-gray-800 shadow-xl rounded-lg p-6 md:p-8 mb-8 text-center border border-gray-700">
    <h2 class="text-2xl md:text-3xl font-bold mb-2 text-white">
      <%= Time.current.strftime("%A, %B %d") %>
    </h2>
    <p class="text-gray-400 mb-8 text-lg">Current Status: 
      <% if @active_attendance %>
        <span class="text-green-400 font-bold">Checked In</span>
      <% else %>
        <span class="text-gray-500 font-bold">Checked Out</span>
      <% end %>
    </p>

    <div class="mb-8">
      <%= link_to leave_requests_path, class: "inline-flex items-center gap-2 bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 px-6 rounded-full shadow-md transition duration-200 border border-indigo-500 hover:-translate-y-0.5" do %>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5" />
        </svg>
        Request Time Off
      <% end %>
    </div>

    <% if @active_attendance %>
      <%= button_to "Check Out Now", attendance_path(@active_attendance), method: :patch, class: "bg-red-600 hover:bg-red-700 text-white font-bold py-4 px-10 rounded-full text-xl md:text-2xl shadow-lg transition duration-200 border border-red-500 cursor-pointer w-full md:w-auto shadow-red-900/20" %>
      <p class="mt-4 text-sm text-gray-500">Checked in at: <%= @active_attendance.check_in.strftime("%I:%M %p") %></p>
    <% else %>
      <div data-controller="checkin">
        <%= form_with url: attendances_path, method: :post, data: { checkin_target: "form" } do |f| %>
          <%= hidden_field_tag :latitude, nil, data: { checkin_target: "lat" } %>
          <%= hidden_field_tag :longitude, nil, data: { checkin_target: "lng" } %>

          <button 
            data-action="click->checkin#submit" 
            data-checkin-target="button"
            class="bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-10 rounded-full text-xl md:text-2xl shadow-lg transition duration-200 border border-green-500 w-full md:w-auto cursor-pointer shadow-green-900/20">
            Check In Now
          </button>
        <% end %>
      </div>
    <% end %>
  </div>

  <div class="bg-gray-800 shadow rounded-lg overflow-hidden border border-gray-700">
    <div class="px-6 py-4 border-b border-gray-700 bg-gray-900 flex justify-between items-center">
      <h3 class="text-lg font-semibold text-white">Attendance History</h3>
      <span class="text-xs text-gray-500 md:hidden">Swipe &rarr;</span>
    </div>
    
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-700">
        <thead class="bg-gray-900">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider whitespace-nowrap">Date</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider whitespace-nowrap">Check In</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider whitespace-nowrap">Check Out</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider whitespace-nowrap">Duration</th>
          </tr>
        </thead>
        <tbody class="bg-gray-800 divide-y divide-gray-700">
          <% @attendances.each do |attendance| %>
            <tr class="hover:bg-gray-700 transition">
              <td class="px-6 py-4 whitespace-nowrap text-gray-300"><%= attendance.check_in.strftime("%Y-%m-%d") %></td>
              <td class="px-6 py-4 whitespace-nowrap text-gray-300"><%= attendance.check_in.strftime("%I:%M %p") %></td>
              <td class="px-6 py-4 whitespace-nowrap text-gray-300">
                <%= attendance.check_out ? attendance.check_out.strftime("%I:%M %p") : "Active" %>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-gray-300">
                <% if attendance.check_out %>
                  <%= ((attendance.check_out - attendance.check_in) / 3600).round(2) %> hrs
                <% else %>
                  -
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <div class="p-4 bg-gray-900 border-t border-gray-700">
      <%= paginate @attendances %>
    </div>
  </div>
</div>