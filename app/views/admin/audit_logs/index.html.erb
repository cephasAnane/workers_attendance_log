<div class="container mx-auto px-4 py-8">
  <h2 class="text-2xl font-bold text-white mb-6">System Audit Trail</h2>

  <div class="bg-gray-800 shadow-lg rounded-lg overflow-hidden border border-gray-700">
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-700">
        <thead class="bg-gray-900">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase">Who (Admin)</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase">Action</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase">Item Changed</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase">Date</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase">Details</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-700">
          <% @versions.each do |v| %>
            <% user = User.find_by(id: v.whodunnit) %>
            <tr class="hover:bg-gray-700 transition">
              <td class="px-6 py-4 text-sm text-white">
                <%= user ? user.full_name : "System / Unknown" %>
              </td>

              <td class="px-6 py-4 text-sm">
                <% color = case v.event; when 'create' then 'text-green-400'; when 'update' then 'text-blue-400'; when 'destroy' then 'text-red-400'; end %>
                <span class="<%= color %> font-bold uppercase text-xs"><%= v.event %></span>
              </td>

              <td class="px-6 py-4 text-sm text-gray-300">
                <%= v.item_type %> #<%= v.item_id %>
              </td>

              <td class="px-6 py-4 text-sm text-gray-400 whitespace-nowrap">
                <%= v.created_at.strftime("%b %d, %H:%M") %>
              </td>

              <td class="px-6 py-4 text-xs text-gray-500 font-mono break-all max-w-xs">
                <% if v.event == 'update' && v.changeset %>
                  <% v.changeset.each do |field, values| %>
                    <% next if ['updated_at', 'created_at'].include?(field) %>
                    <div>
                      <strong class="text-gray-300"><%= field %>:</strong> 
                      <span class="text-red-400"><%= values[0] %></span> &rarr; 
                      <span class="text-green-400"><%= values[1] %></span>
                    </div>
                  <% end %>
                <% else %>
                  <span>Record <%= v.event %>d</span>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>